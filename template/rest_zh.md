
.. _rest_api:

======================
管理监控API (REST API)
======================

用户可以通过 REST API 查询 MQTT 客户端连接(Clients)、会话(Sessions)、订阅(Subscriptions)和路由(Routes)信息，还可以检索和监控服务器的性能指标和统计数据。

----------
URL 地址
---------

REST API 访问URL地址::

    http(s)://host:8080/api/v3/

-----------
Basic 认证
-----------

REST API 采用 HTTP Basic 认证(Authentication), 使用 Dashboard 中创建的 AppID 和 AppSecret 进行认证:

.. code-block:: bash

    curl -v --basic -u <appid>:<appsecret> -k http://localhost:8080/api/v3/brokers

----------
API 信息
----------

获取当前 REST API 列表
----------------------

## list_all_api


----------
集群与节点
----------

获取集群基本信息
----------------------

## list_brokers


获取节点基本信息
----------------------

## get_broker

获取集群监控数据
----------------------

## list_nodes

获取节点监控数据
----------------------

## get_node

-------------------
连接信息(Connections)
-------------------

获取集群连接信息
----------------------------

## list_connections


获取节点连接信息
----------------------------

## list_node_connections



获取集群指定连接信息
--------------------------

## lookup_connections


获取节点指定连接信息
----------------------------

## lookup_node_connections



断开指定连接
------------------

## kickout_connections



--------------
会话(Sessions)
--------------

获取集群会话信息
------------------------------

## list_sessions


获取集群指定会话信息
------------------------------

## lookup_session


获取节点会话信息
----------------------

## list_node_sessions



获取节点指定会话信息
------------------------------

## lookup_node_session




-------------------
订阅(Subscriptions)
-------------------


获取集群订阅信息
------------------------

## list_subscriptions


获取集群指定连接订阅信息
------------------------

## lookup_client_subscriptions


获取节点订阅信息
------------------------------

## list_node_subscriptions

获取节点指定连接订阅信息
------------------------------
## lookup_client_subscriptions_with_node

------------
路由(Routes)
------------

获取集群路由表
--------------

## list_nodes


获取集群指定主题的路由信息
----------------------------

## lookup_routes



------------------
发布/订阅/取消订阅
------------------

发布消息
--------

## mqtt_publish


创建订阅
--------

## mqtt_subscribe


取消订阅
--------

## mqtt_unsubscribe

-------------
插件(Plugins)
-------------

获取集群插件列表
------------------

## list_all_plugins


获取节点插件列表
------------------

## list_node_plugins


启用节点指定插件
-----------------------

## load_plugin


关闭节点指定插件
-----------------------

## unload_plugin


------------------
监听器(Listeners)
------------------

获取集群监听器列表
------------------------

## list_listeners


获取节点监听器列表
------------------------

## list_node_listeners

------------
收发报文统计
------------

获取集群收发报文统计
--------------------------

## list_all_metrics

获取节点收发报文统计
--------------------------

## list_node_metrics


-------------
连接会话统计
-------------

获取集群连接会话统计
---------------------------

## list_stats

获取节点连接会话统计
--------------------------

## lookup_node_stats



----------
告警信息
----------

获取集群告警信息
---------------------------

## list_node_alarms

获取节点告警信息
--------------------------

## list_all_alarms



----------
黑名单
----------

获取黑名单列表
---------------------------

## list_banned

创建黑名单
--------------------------

## create_banned

删除指定黑名单
--------------------------

## delete_banned



----------------
错误信息与数据分页
----------------

HTTP状态码大于500时响应携带错误信息返回
---------------------------------

错误示例::

    PUT api/v3/nodes/emqx@127.0.0.1/plugins/emqx_recon/load

返回数据:

.. code-block:: json

    {
        "message": "already_started"
    }


分页参数与分页信息
---------------

请求示例中使用了 ?_page=1&_limit=10000 参数的接口均支持分页::

    _page: 当前页码
    _limit: 分页大小
    
    
返回数据:

.. code-block:: json    

    {
      "items": [],
      "meta": {
          "page": 1,
          "limit": 10000,
          "count": 2
      }
    }
    
